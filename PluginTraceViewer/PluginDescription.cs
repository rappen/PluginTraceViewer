namespace Cinteros.XTB.PluginTraceViewer
{
    using System.ComponentModel.Composition;
    using System.Linq;
    using XrmToolBox.Extensibility;
    using XrmToolBox.Extensibility.Interfaces;

    [Export(typeof(IXrmToolBoxPlugin)),
        ExportMetadata("Name", "Plugin Trace Viewer"),
        ExportMetadata("Description", "Investigate the Plugin Trace Log with easy filtering and display possibilities"),
        ExportMetadata("SmallImageBase64", "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"),
        ExportMetadata("BigImageBase64", "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"),
        ExportMetadata("BackgroundColor", "#FFFFC0"),
        ExportMetadata("PrimaryFontColor", "#0000C0"),
        ExportMetadata("SecondaryFontColor", "#0000FF")]
    public class PluginTraceViewerPlugin : PluginBase, IPayPalPlugin
    {
        public string DonationDescription => "Plugin Trace Viewer Fan Club";

        public string EmailAccount => "jonas@rappen.net";

        public override IXrmToolBoxPluginControl GetControl()
        {
            var tool = new PluginTraceViewer();
            tool.SaveImageFromBase64(
                tool.IconBigPath,
                GetType()
                .GetCustomAttributes(typeof(ExportMetadataAttribute), false)
                .OfType<ExportMetadataAttribute>()
                .FirstOrDefault(a => a.Name == "BigImageBase64")?.Value as string);
            tool.SaveImageFromBase64(
                tool.IconSmallPath,
                GetType()
                .GetCustomAttributes(typeof(ExportMetadataAttribute), false)
                .OfType<ExportMetadataAttribute>()
                .FirstOrDefault(a => a.Name == "SmallImageBase64")?.Value as string);
            return tool;
        }
    }
}